<!DOCTYPE html>
<html>
  <head>
    <title>Map</title>
    <link rel="stylesheet" type="text/css" href="../styles/styles.css">
    <script src="../js/jquery.js"></script> 
    <script> 
    $(document).ready(function() {
      $('#head').load('template.html .header');
      $('#foot').load('template.html .footer');

    });
    </script> 
  </head>
  <body>
    <div id="head"></div>

    <div id="mapbanner" class="banner">
        <h1>The Cyc-Map</h1>
      </div>

    <form id="location-form">
        <label for="location-input">Location:</label>
        <input type="text" id="location-input">
        <button type="submit">Add Location</button>
    </form>
    <div id="map"></div>
    <div style="width: 100%">
        <iframe src="https://www.google.com/maps/embed?pb=!1m16!1m12!1m3!1d124415.12063321698!2d77.49073772394969!3d12.973609433955623!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!2m1!1se%20waste%20recyclers!5e0!3m2!1sen!2sin!4v1685696416375!5m2!1sen!2sin" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
    <script>
        // Array to store the added locations
        let locations = [];
    
        // Function to initialize the map
        function initMap() {
        const map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: 0, lng: 0 }, // Set the initial center of the map
            zoom: 2, // Set the initial zoom level of the map
        });
    
        // Function to add a marker/pin on the map
        function addMarker(location) {
            new google.maps.Marker({
            position: location,
            map: map,
            });
        }
    
        // Add markers for existing locations
        locations.forEach(function (location) {
            addMarker(location);
        });
    
        // Event listener for form submission
        document.getElementById("location-form").addEventListener("submit", function (event) {
            event.preventDefault(); // Prevent the default form submission
    
            const input = document.getElementById("location-input");
            const location = input.value; // Get the location input value
    
            // Geocode the location to get its latitude and longitude
            const geocoder = new google.maps.Geocoder();
            geocoder.geocode({ address: location }, function (results, status) {
            if (status === google.maps.GeocoderStatus.OK) {
                const latLng = results[0].geometry.location;
                addMarker(latLng); // Add the marker on the map
                locations.push(latLng); // Store the location in the array
                input.value = ""; // Clear the input field
            } else {
                console.log("Geocode was not successful for the following reason: " + status);
            }
            });
        });
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
    <div id="foot"></div>
    </body>
</html> 